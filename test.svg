<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     viewBox="0 0 500 200"
     style="font-family: sans-serif;">
    
    <style>
        /* Base Styling */
        .cta-text {
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 24px;
            fill: #1f2937; /* Default dark text */
        }
        
        /* Background rectangle for the SVG */
        <rect width="500" height="200" fill="#f7f7f7"/>

        /* ----------------------------------------------------------- */
        /* CSS to demonstrate visual change based on detected browser  */
        /* ----------------------------------------------------------- */
        
        /* Firefox */
        svg.browser-firefox #dynamic-circle { fill: #ff7800; }
        
        /* Chrome */
        svg.browser-chrome #dynamic-rectangle { fill: #3b82f6; opacity: 0.7; }
        
        /* Edge */
        svg.browser-edge #dynamic-rectangle { fill: #0078d4; }
        
        /* Brave */
        svg.browser-brave #dynamic-circle { fill: #9147ff; }
        
        /* Opera */
        svg.browser-opera #dynamic-rectangle { fill: #cc0f16; }

        /* Unknown/Unsupported - Highlight the CTA text in a warning color */
        svg.browser-unknown .cta-text { fill: #dc2626; }
        
        /* Dark Mode support (if the SVG is opened directly) */
        @media (prefers-color-scheme: dark) {
            rect { fill: #1f2937; } /* Dark background */
            .cta-text { fill: #f3f4f6; } /* Light text */
            #dynamic-circle { fill: #34d399; } /* Emerald */
            #dynamic-rectangle { fill: #f87171; } /* Red */
        }
    </style>

    <!-- Dynamic elements for visual change -->
    <circle id="dynamic-circle" cx="150" cy="100" r="40" fill="#4f46e5"/>
    <rect id="dynamic-rectangle" x="300" y="50" width="100" height="100" fill="#f59e0b" />

    <!-- The dynamic Call-to-Action text element -->
    <text id="browser-text-cta" x="250" y="180" class="cta-text" text-anchor="middle">
        Loading CTA...
    </text>

    <!-- Embedded JavaScript for browser detection and DOM manipulation -->
    <script type="text/ecmascript">
        <![CDATA[
        function detectBrowser() {
            const userAgent = navigator.userAgent;
            const svg = document.querySelector('svg');
            const browserCta = document.getElementById('browser-text-cta');
            
            let browserName = "Unknown";
            let browserClass = "browser-unknown";
            let ctaText = "CHECK COMPATIBILITY";

            // Logic to identify the supported browsers
            if (userAgent.includes("Brave")) {
                browserName = "Brave";
                browserClass = "browser-brave";
                ctaText = "GET FOR BRAVE";
            } else if (userAgent.includes("Edg")) {
                browserName = "Edge";
                browserClass = "browser-edge";
                ctaText = "GET FOR EDGE";
            } else if (userAgent.includes("OPR") || userAgent.includes("Opera")) {
                browserName = "Opera";
                browserClass = "browser-opera";
                ctaText = "GET FOR OPERA";
            } else if (userAgent.includes("Firefox")) {
                browserName = "Firefox";
                browserClass = "browser-firefox";
                ctaText = "GET FOR FIREFOX";
            } else if (userAgent.includes("Chrome") && !userAgent.includes("Edg")) {
                browserName = "Chrome";
                browserClass = "browser-chrome";
                ctaText = "GET FOR CHROME";
            } 
            
            // 1. Add class to the root SVG element for CSS targeting
            svg.classList.add(browserClass);

            // 2. Update the SVG text content
            browserCta.textContent = ctaText;
        }

        // Run the detection function immediately
        window.addEventListener('load', detectBrowser);
        ]]>
    </script>
</svg>